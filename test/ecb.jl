using AESNI
using Test

@testset "ECB" begin
    # https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Standards-and-Guidelines/documents/examples/AES_ECB.pdf
    plain = bytes"""6BC1BEE2 2E409F96 E93D7E11 7393172A
    AE2D8A57 1E03AC9C 9EB76FAC 45AF8E51
    30C81C46 A35CE411 E5FBC119 1A0A52EF
    F69F2445 DF4F9B17 AD2B417B E66C3710"""

    @test_cipher(
        Aes128Ecb,
        bytes"2B7E1516 28AED2A6 ABF71588 09CF4F3C",
        plain,
        bytes"3AD77BB4 0D7A3660 A89ECAF3 2466EF97
        F5D3D585 03B9699D E785895A 96FDBAAF
        43B1CD7F 598ECE23 881B00E3 ED030688
        7B0C785E 27E8AD3F 82232071 04725DD4"
    )

    @test_cipher(
        Aes192Ecb,
        bytes"8E73B0F7 DA0E6452 C810F32B 809079E5 62F8EAD2 522C6B7B",
        plain,
        bytes"BD334F1D 6E45F25F F712A214 571FA5CC
        97410484 6D0AD3AD 7734ECB3 ECEE4EEF
        EF7AFD22 70E2E60A DCE0BA2F ACE6444E
        9A4B41BA 738D6C72 FB166916 03C18E0E"
    )

    @test_cipher(
        Aes256Ecb,
        bytes"603DEB10 15CA71BE 2B73AEF0 857D7781
        1F352C07 3B6108D7 2D9810A3 0914DFF4",
        plain,
        bytes"F3EED1BD B5D2A03C 064B5A7E 3DB181F8
        591CCB10 D410ED26 DC5BA74A 31362870
        B6ED21B9 9CA6F4F9 F153E7B1 BEAFED1D
        23304B7A 39F9F3FF 067D8D8F 9E24ECC7"
    )
end
